<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hello Bulma!</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
</head>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <strong class="navbar-item">
      Personal Finance
    </strong>

    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      <a class="navbar-item">
        Home
      </a>

      <a class="navbar-item">
        Documentation
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item">
            About
          </a>
          <a class="navbar-item">
            Jobs
          </a>
          <a class="navbar-item">
            Contact
          </a>
          <hr class="navbar-divider">
          <a class="navbar-item">
            Report an issue
          </a>
        </div>
      </div>
    </div>

    <div class="navbar-end">
      <div class="navbar-item">
        <div class="buttons">
          <a class="button is-primary">
            <strong>Sign up</strong>
          </a>
          <a class="button is-light">
            Log in
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>

<div class="container">
  <nav class="panel">
    <p class="panel-heading">
      Repositories
    </p>
    <div class="panel-block">
      <p class="control has-icons-left">
        <input class="input" type="text" placeholder="Search">
        <span class="icon is-left">
          <i class="fas fa-search" aria-hidden="true"></i>
        </span>
      </p>
    </div>
    <p class="panel-tabs">
      <a class="is-active" href="/accounts">Accounts</a>
      <a>Transactions</a>
      <a>Tags</a>
      <a>Sources</a>
      <a>Forks</a>
    </p>
    <a class="panel-block is-active">
      <span class="panel-icon">
        <i class="fas fa-book" aria-hidden="true"></i>
      </span>
      bulma
    </a>
    <a class="panel-block">
      <span class="panel-icon">
        <i class="fas fa-book" aria-hidden="true"></i>
      </span>
      marksheet
    </a>
    <a class="panel-block">
      <span class="panel-icon">
        <i class="fas fa-book" aria-hidden="true"></i>
      </span>
      minireset.css
    </a>
    <a class="panel-block">
      <span class="panel-icon">
        <i class="fas fa-book" aria-hidden="true"></i>
      </span>
      jgthms.github.io
    </a>
    <a class="panel-block">
      <span class="panel-icon">
        <i class="fas fa-code-branch" aria-hidden="true"></i>
      </span>
      daniellowtw/infboard
    </a>
    <a class="panel-block">
      <span class="panel-icon">
        <i class="fas fa-code-branch" aria-hidden="true"></i>
      </span>
      mojs
    </a>
    <label class="panel-block">
      <input type="checkbox">
      remember me
    </label>
    <div class="panel-block">
      <button class="button is-link is-outlined is-fullwidth">
        Reset all filters
      </button>
    </div>
  </nav>
</div>

<!--
<h1>People</h1>
<% @people.each do |person| %>
  Person: <%= person.name %>
  <br>
<% end %>

<h3>Create people</h3>
<form action="/people" method="post">
  <label for="name">Person name:</label>
  <input name="name" type="text">
  <input type="submit">Create Person</input>
</form>
-->

<h1>Accounts</h1>
<% if @accounts.length == 0 %>
  No accounts
<% else %>
  <% @accounts.each do |account| %>
    Account: <%= account.name %>
    <br>
  <% end %>
<% end %>

<h3>Create accounts</h3>
<form action="/accounts" method="post">
  <label for="name">Account name:</label>
  <input name="name" type="text">
  <input type="submit">Create Account</input>
</form>

<h3>Create transactions</h3>
<form action="/transactions" method="post">
  <label for="name">Name</label>
  <input name="name" />
  <label for="account_id">Account</label>
  <select id="idk" name="account_id">
    <% @accounts.each do |a| %>
      <option value="<%= a.id %>"><%= a.name %></option>
    <% end %>
  </select>
  <label for="amount">Amount</label>
  <input name="amount" type="number" step="0.01" />

  <label for="currency">Currency</label>
  <input name="currency" type="text" />

  <label for="day_of_month">Day of month</label>
  <input name="day_of_month" type="number" />

  <input type="submit">Create Transaction</input>
</form>

<form id="accountform">
  <input type="submit">Filter to this account</input>
</form>

<select id="idk" name="account" form="accountform">
  <% @accounts.each do |a| %>
    <option value="<%= a.id %>"><%= a.name %></option>
  <% end %>
</select>

<h1>Transactions</h1>
<% @cash_flow.each do |i| %>
  <span><%= "#{i.name} | #{i.amount} | Occurs on: #{i.day_of_month} | "%></span>
  <% if @tag_index[i.id] %>
    <%= @tag_index[i.id].map(&:name) %>
  <% end %>
  <form action="/transaction_tags" method="post" name="transaction_#{i.id}_tag_form">
    <label for="name">Tag this transaction</label>
    <input name="name" type="text" />
    <input name="transaction_id" value="<%= i.id %>" hidden />
    <input type="submit" />
  </form>
<% end %>

<h1>Tags</h1>
<select id="tagselect" name="transaction_tag[]" form="tagform" multiple>
  <% @tag_index.values.flatten.map(&:name).uniq.each do |a| %>
    <option value="<%= a %>"><%= a %></option>
  <% end %>
</select>

<form id="tagform">
  <label for="intersection">Intersection</label>
  <% if @is_tag_intersection %>
    <input name="intersection" type="checkbox" checked />
  <% else %>
    <input name="intersection" type="checkbox" />
  <% end %>
  <input type="submit">Filter to this tag</input>
  <input type="text" name="title"></input>
  <button type="submit" formaction="/transaction_tag_sets" formmethod="POST"> Save as Tag Set</button>
</form>

<% if @tagged_transactions %>
  <% @tagged_transactions.each do |tagged_transaction| %>
    <h3><%= "#{tagged_transaction[:title]}" %></h3>
    <h3><%= tagged_transaction[:tags] %></h3>
    <h4><%= @is_tag_intersection ? 'intersection of tags' : 'union of tags' %></h4>
    <% tagged_transaction[:transaction_set].transactions.each do |t| %>
      <%= "#{t.name} | Amount: #{t.amount} | account id: #{t.account_id} | day: #{t.day_of_month}" %>
      <br>
    <% end %>
    <p>Sum: <%= tagged_transaction[:transaction_set].sum %></p>
    <% end %>
<% end %>

<h1>Tag Sets</h1>

<form id="tagsetform">
  <select id="tagsettagselect" name="transaction_tag_set[]" form="tagsetform" multiple>
    <% @tag_sets.each do |tag_set| %>
      <option value="<%= tag_set.id %>"><%= tag_set.title %></option>
    <% end %>
  </select>
  <input type="submit">Filter to these tag sets</input>
</form>


